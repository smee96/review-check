# ğŸš€ ì…€ëŸ¬ë¦¬ ì—ì´ì „íŠ¸ ê°œë°œ ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ

## ğŸ“¦ ì œê³µëœ íŒŒì¼ ëª©ë¡

```
admin-api-docs/
â”œâ”€â”€ README.md                    # ì „ì²´ API ë¬¸ì„œ
â”œâ”€â”€ ENV_SAMPLE.md               # í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ê°€ì´ë“œ
â”œâ”€â”€ POSTMAN_COLLECTION.json     # Postman API í…ŒìŠ¤íŠ¸ ì»¬ë ‰ì…˜
â”œâ”€â”€ QUICK_START.md              # ì´ íŒŒì¼
â”œâ”€â”€ admin-routes.ts             # ê´€ë¦¬ì ë¼ìš°íŠ¸ ì½”ë“œ
â”œâ”€â”€ campaigns-routes.ts         # ìº í˜ì¸ ë¼ìš°íŠ¸ ì½”ë“œ
â”œâ”€â”€ applications-routes.ts      # ì§€ì›/ë¦¬ë·° ë¼ìš°íŠ¸ ì½”ë“œ
â”œâ”€â”€ settings-routes.ts          # ì‹œìŠ¤í…œ ì„¤ì • ë¼ìš°íŠ¸ ì½”ë“œ
â”œâ”€â”€ auth-middleware.ts          # ì¸ì¦ ë¯¸ë“¤ì›¨ì–´
â””â”€â”€ migrations/                 # ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
    â”œâ”€â”€ 0001_initial_schema.sql
    â”œâ”€â”€ 0002_add_advertiser_profile.sql
    â””â”€â”€ ...
```

---

## ğŸ¯ ê°œë°œ ëª©í‘œ

ì…€ëŸ¬ë¦¬ ì—ì´ì „íŠ¸ì—ì„œ ë‹¤ìŒ ê¸°ëŠ¥ì„ êµ¬í˜„:

1. **ìº í˜ì¸ ê´€ë¦¬** - ì „ì²´ ìº í˜ì¸ ì¡°íšŒ, ìƒíƒœ ë³€ê²½, ì‚­ì œ
2. **ë¦¬ë·° ê´€ë¦¬** - ë¦¬ë·° ì¡°íšŒ, ìŠ¹ì¸/ê±°ì ˆ
3. **ê°€ì…ì ëª©ë¡** - ì‚¬ìš©ì ì¡°íšŒ, ìƒíƒœ ê´€ë¦¬, í¬ì¸íŠ¸ ì¡°ì •
4. **ì •ì‚° ê´€ë¦¬** - ì •ì‚° ìš”ì²­ ì¡°íšŒ, ìŠ¹ì¸/ê±°ì ˆ
5. **ì‹œìŠ¤í…œ ì„¤ì •** - ìˆ˜ìˆ˜ë£Œìœ¨, ìµœì†Œ/ìµœëŒ€ ê¸ˆì•¡ ì„¤ì •

---

## ğŸ”§ 1ë‹¨ê³„: API í…ŒìŠ¤íŠ¸ (Postman ì‚¬ìš©)

### Postman ì»¬ë ‰ì…˜ ì„í¬íŠ¸

1. **Postman ì—´ê¸°**
2. **Import** ë²„íŠ¼ í´ë¦­
3. **`POSTMAN_COLLECTION.json`** íŒŒì¼ ì„ íƒ
4. ì»¬ë ‰ì…˜ ì„í¬íŠ¸ ì™„ë£Œ

### í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

Postmanì—ì„œ `baseUrl` ë³€ìˆ˜ í™•ì¸:
```
baseUrl: https://fa737302.checknreviews-v1.pages.dev
```

### ì²« API í˜¸ì¶œ í…ŒìŠ¤íŠ¸

1. **ë¡œê·¸ì¸ ìš”ì²­**
   ```
   POST /api/auth/login
   Body:
   {
     "email": "admin@example.com",
     "password": "your_password"
   }
   ```

2. **ì„¸ì…˜ ì¿ í‚¤ ìë™ ì €ì¥**
   - Postmanì´ ìë™ìœ¼ë¡œ ì¿ í‚¤ ì €ì¥
   - ì´í›„ ìš”ì²­ì— ìë™ í¬í•¨

3. **ìº í˜ì¸ ëª©ë¡ ì¡°íšŒ**
   ```
   GET /api/admin/campaigns?status=all&page=1&limit=20
   ```

---

## ğŸ’» 2ë‹¨ê³„: ì½”ë“œ êµ¬ì¡° ì´í•´

### ì¸ì¦ íë¦„
```typescript
// auth-middleware.ts ì°¸ê³ 
1. ë¡œê·¸ì¸ â†’ ì„¸ì…˜ ìƒì„± â†’ ì¿ í‚¤ ë°œê¸‰
2. ì´í›„ ìš”ì²­ ì‹œ ì¿ í‚¤ë¡œ ì‚¬ìš©ì í™•ì¸
3. role === 'admin' ì²´í¬
```

### API ì‘ë‹µ í˜•ì‹
```typescript
// ì„±ê³µ
{
  "message": "ì„±ê³µ ë©”ì‹œì§€",
  "data": { ... }
}

// ì‹¤íŒ¨
{
  "error": "ì—ëŸ¬ ë©”ì‹œì§€",
  "details": "ìƒì„¸ ì •ë³´"
}
```

### ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼
```typescript
// Cloudflare D1 (SQLite) ì‚¬ìš©
const result = await c.env.DB.prepare(`
  SELECT * FROM campaigns WHERE status = ?
`).bind('active').all();
```

---

## ğŸ› ï¸ 3ë‹¨ê³„: ì…€ëŸ¬ë¦¬ì—ì„œ êµ¬í˜„í•˜ê¸°

### Option A: REST API í˜¸ì¶œ ë°©ì‹ (ì¶”ì²œ)

ì…€ëŸ¬ë¦¬ì—ì„œ HTTP ìš”ì²­ìœ¼ë¡œ ê¸°ì¡´ API í˜¸ì¶œ:

```typescript
// ì˜ˆì‹œ: ìº í˜ì¸ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
const response = await fetch('https://fa737302.checknreviews-v1.pages.dev/api/admin/campaigns?status=all&page=1&limit=20', {
  method: 'GET',
  headers: {
    'Cookie': 'session=xxx', // ë¡œê·¸ì¸ í›„ ë°›ì€ ì„¸ì…˜ ì¿ í‚¤
  }
});

const data = await response.json();
console.log(data.campaigns);
```

**ì¥ì :**
- ê¸°ì¡´ APIë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©
- ì½”ë“œ ì¤‘ë³µ ì—†ìŒ
- ì¸ì¦/ê¶Œí•œ ê²€ì¦ ì¬ì‚¬ìš©

---

### Option B: ì§ì ‘ ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼ ë°©ì‹

ì…€ëŸ¬ë¦¬ì—ì„œ Cloudflare D1ì— ì§ì ‘ ì—°ê²°:

```typescript
// wrangler.jsoncì— D1 ë°”ì¸ë”© ì¶”ê°€
{
  "d1_databases": [
    {
      "binding": "DB",
      "database_name": "checknreviews-v1-production",
      "database_id": "your-database-id"
    }
  ]
}

// ì½”ë“œì—ì„œ ì§ì ‘ ì¿¼ë¦¬
const campaigns = await env.DB.prepare(`
  SELECT 
    c.*,
    u.nickname as advertiser_nickname,
    COUNT(a.application_id) as application_count
  FROM campaigns c
  LEFT JOIN users u ON c.advertiser_id = u.user_id
  LEFT JOIN applications a ON c.campaign_id = a.campaign_id
  WHERE c.status = ?
  GROUP BY c.campaign_id
`).bind('active').all();
```

**ì¥ì :**
- ë” ìœ ì—°í•œ ì¿¼ë¦¬ ê°€ëŠ¥
- ì„±ëŠ¥ ìµœì í™” ê°€ëŠ¥

**ë‹¨ì :**
- ì½”ë“œ ì¤‘ë³µ
- ì¸ì¦/ê¶Œí•œ ê²€ì¦ ì§ì ‘ êµ¬í˜„ í•„ìš”

---

## ğŸ“Š 4ë‹¨ê³„: UI êµ¬ì„± ì˜ˆì‹œ

### ëŒ€ì‹œë³´ë“œ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ì²´í¬ì•¤ë¦¬ë·° ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“Š ì˜¤ëŠ˜ ë°©ë¬¸ì: 150ëª…               â”‚
â”‚  ğŸ‘¥ ì „ì²´ ì‚¬ìš©ì: 1,234ëª…             â”‚
â”‚  ğŸ“¢ ì „ì²´ ìº í˜ì¸: 56ê°œ                â”‚
â”‚  â­ ë¦¬ë·° ëŒ€ê¸°: 12ê±´                  â”‚
â”‚  ğŸ’° ì •ì‚° ëŒ€ê¸°: 5ê±´                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ìº í˜ì¸ ëª©ë¡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ìº í˜ì¸ ê´€ë¦¬                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ID   â”‚ ì œëª©      â”‚ ê´‘ê³ ì£¼  â”‚ ìƒíƒœ    â”‚ ì•¡ì…˜      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1    â”‚ ì‹ ì œí’ˆ... â”‚ ê´‘ê³ ì£¼A â”‚ active  â”‚ [ìƒì„¸][ì‚­ì œ]â”‚
â”‚ 2    â”‚ ì´ë²¤íŠ¸... â”‚ ê´‘ê³ ì£¼B â”‚ pending â”‚ [ìŠ¹ì¸][ê±°ì ˆ]â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” 5ë‹¨ê³„: ì£¼ìš” ê¸°ëŠ¥ë³„ API ë§¤í•‘

### ìº í˜ì¸ ê´€ë¦¬
```
âœ… ëª©ë¡ ì¡°íšŒ: GET /api/admin/campaigns
âœ… ìƒì„¸ ë³´ê¸°: GET /api/campaigns/:id
âœ… ìƒíƒœ ë³€ê²½: PUT /api/admin/campaigns/:id/status
âœ… ì‚­ì œ: DELETE /api/admin/campaigns/:id
```

### ë¦¬ë·° ê´€ë¦¬
```
âœ… ëª©ë¡ ì¡°íšŒ: GET /api/admin/reviews
âœ… ìŠ¹ì¸/ê±°ì ˆ: PUT /api/admin/reviews/:id/status
```

### ê°€ì…ì ê´€ë¦¬
```
âœ… ëª©ë¡ ì¡°íšŒ: GET /api/admin/users
âœ… ìƒì„¸ ë³´ê¸°: GET /api/admin/users/:id
âœ… ìƒíƒœ ë³€ê²½: PUT /api/admin/users/:id/status
âœ… í¬ì¸íŠ¸ ì¡°ì •: POST /api/admin/users/:id/points
```

### ì •ì‚° ê´€ë¦¬
```
âœ… ëª©ë¡ ì¡°íšŒ: GET /api/admin/settlements
âœ… ìŠ¹ì¸/ê±°ì ˆ: PUT /api/admin/settlements/:id/status
âœ… CSV ë‹¤ìš´ë¡œë“œ: GET /api/admin/settlements/export
```

### ì‹œìŠ¤í…œ ì„¤ì •
```
âœ… ì„¤ì • ì¡°íšŒ: GET /api/admin/settings
âœ… ì„¤ì • ë³€ê²½: PUT /api/admin/settings/:key
```

---

## ğŸ§ª 6ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### 1. ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
```bash
curl -X POST https://fa737302.checknreviews-v1.pages.dev/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@example.com","password":"your_password"}' \
  -c cookies.txt
```

### 2. ìº í˜ì¸ ëª©ë¡ ì¡°íšŒ
```bash
curl -X GET https://fa737302.checknreviews-v1.pages.dev/api/admin/campaigns \
  -b cookies.txt
```

### 3. ìº í˜ì¸ ìŠ¹ì¸
```bash
curl -X PUT https://fa737302.checknreviews-v1.pages.dev/api/admin/campaigns/1/status \
  -H "Content-Type: application/json" \
  -d '{"status":"active"}' \
  -b cookies.txt
```

---

## ğŸ“š 7ë‹¨ê³„: ì¶”ê°€ ì°¸ê³  ìë£Œ

### README.md
- ì „ì²´ API ì—”ë“œí¬ì¸íŠ¸ ë¬¸ì„œ
- ìš”ì²­/ì‘ë‹µ ì˜ˆì‹œ
- ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### ENV_SAMPLE.md
- í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
- ê´€ë¦¬ì ê³„ì • ìƒì„± ë°©ë²•
- ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”

### ì†ŒìŠ¤ ì½”ë“œ íŒŒì¼
- `admin-routes.ts`: ê´€ë¦¬ì API êµ¬í˜„ ì½”ë“œ
- `campaigns-routes.ts`: ìº í˜ì¸ API êµ¬í˜„ ì½”ë“œ
- `auth-middleware.ts`: ì¸ì¦ ë¡œì§

### ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼
- `migrations/*.sql`: ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì •ì˜

---

## ğŸ¯ ì¶”ì²œ ê°œë°œ ìˆœì„œ

1. **Postmanìœ¼ë¡œ API í…ŒìŠ¤íŠ¸** (30ë¶„)
   - ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ í…ŒìŠ¤íŠ¸
   - ì‘ë‹µ êµ¬ì¡° í™•ì¸

2. **ëŒ€ì‹œë³´ë“œ í†µê³„ êµ¬í˜„** (1ì‹œê°„)
   - GET /api/admin/stats
   - ê°„ë‹¨í•œ í†µê³„ ì¹´ë“œ í‘œì‹œ

3. **ìº í˜ì¸ ëª©ë¡ êµ¬í˜„** (2ì‹œê°„)
   - GET /api/admin/campaigns
   - í…Œì´ë¸” í˜•íƒœë¡œ í‘œì‹œ
   - í˜ì´ì§€ë„¤ì´ì…˜

4. **ìº í˜ì¸ ìƒì„¸/ìŠ¹ì¸ ê¸°ëŠ¥** (2ì‹œê°„)
   - GET /api/campaigns/:id
   - PUT /api/admin/campaigns/:id/status

5. **ë¦¬ë·° ê´€ë¦¬ êµ¬í˜„** (2ì‹œê°„)
   - ë¦¬ë·° ëª©ë¡ ì¡°íšŒ
   - ìŠ¹ì¸/ê±°ì ˆ ê¸°ëŠ¥

6. **ê°€ì…ì ê´€ë¦¬ êµ¬í˜„** (2ì‹œê°„)
   - ì‚¬ìš©ì ëª©ë¡
   - í¬ì¸íŠ¸ ì¡°ì •

7. **ì •ì‚° ê´€ë¦¬ êµ¬í˜„** (2ì‹œê°„)
   - ì •ì‚° ìš”ì²­ ëª©ë¡
   - ìŠ¹ì¸/ê±°ì ˆ

8. **ì‹œìŠ¤í…œ ì„¤ì • êµ¬í˜„** (1ì‹œê°„)
   - ì„¤ì • ì¡°íšŒ/ìˆ˜ì •

**ì´ ì˜ˆìƒ ì‹œê°„: 12-15ì‹œê°„**

---

## ğŸ’¡ íŒ & ì£¼ì˜ì‚¬í•­

### ì¸ì¦ ê´€ë¦¬
- ë¡œê·¸ì¸ í›„ ì„¸ì…˜ ì¿ í‚¤ë¥¼ ì•ˆì „í•˜ê²Œ ì €ì¥
- ê° ìš”ì²­ì— ì¿ í‚¤ ìë™ í¬í•¨ë˜ë„ë¡ ì„¤ì •
- 401 ì‘ë‹µ ì‹œ ì¬ë¡œê·¸ì¸ ì²˜ë¦¬

### ì—ëŸ¬ ì²˜ë¦¬
- ëª¨ë“  API í˜¸ì¶œì— try-catch ì ìš©
- ì‚¬ìš©ì ì¹œí™”ì ì¸ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
- ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì¬ì‹œë„ ë¡œì§

### ì„±ëŠ¥ ìµœì í™”
- ëª©ë¡ ë°ì´í„°ëŠ” í˜ì´ì§€ë„¤ì´ì…˜ í•„ìˆ˜
- ë¶ˆí•„ìš”í•œ API í˜¸ì¶œ ìµœì†Œí™”
- ë¡œë”© ìƒíƒœ í‘œì‹œ

### ë³´ì•ˆ
- ê´€ë¦¬ì ê¶Œí•œ í™•ì¸
- XSS ë°©ì§€ (ì‚¬ìš©ì ì…ë ¥ ê²€ì¦)
- CSRF í† í° (í•„ìš”ì‹œ)

---

## ğŸ†˜ ë¬¸ì œ ë°œìƒ ì‹œ

### API í˜¸ì¶œ ì‹¤íŒ¨
1. ì„¸ì…˜ ì¿ í‚¤ í™•ì¸
2. ê´€ë¦¬ì ê¶Œí•œ í™•ì¸
3. ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸

### ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¥˜
1. ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš© í™•ì¸
2. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í™•ì¸
3. SQL ì¿¼ë¦¬ ì˜¤ë¥˜ ë¡œê·¸ í™•ì¸

### ë°°í¬ ë¬¸ì œ
1. í™˜ê²½ ë³€ìˆ˜ ì„¤ì • í™•ì¸
2. Cloudflare Pages ë¡œê·¸ í™•ì¸
3. wrangler.jsonc ì„¤ì • í™•ì¸

---

## ğŸ“ ì¶”ê°€ ì§€ì›

í•„ìš”í•œ APIê°€ ì—†ê±°ë‚˜ ìˆ˜ì •ì´ í•„ìš”í•˜ë©´:
1. GitHub Issuesì— ìš”ì²­
2. API ë¬¸ì„œ í™•ì¸ í›„ ì§ì ‘ êµ¬í˜„
3. ê¸°ì¡´ ì½”ë“œ ì°¸ê³ í•˜ì—¬ í™•ì¥

**í–‰ìš´ì„ ë¹•ë‹ˆë‹¤! ğŸš€**
