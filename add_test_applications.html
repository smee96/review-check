<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í…ŒìŠ¤íŠ¸ ì§€ì› ë°ì´í„° ì¶”ê°€</title>
    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.0/dist/axios.min.js"></script>
</head>
<body>
    <h1>í…ŒìŠ¤íŠ¸ ì§€ì› ë°ì´í„° ì¶”ê°€ ë„êµ¬</h1>
    <button onclick="addApplications()">ì§€ì› ë°ì´í„° ì¶”ê°€ ì‹¤í–‰</button>
    <div id="log" style="margin-top: 20px; white-space: pre-wrap; font-family: monospace;"></div>

    <script>
    async function addApplications() {
        const log = document.getElementById('log');
        log.textContent = 'ì‹œì‘ì¤‘...\n';

        // ê´€ë¦¬ì ë¡œê·¸ì¸
        const loginEmail = 'admin@reviewsphere.com';
        const loginPassword = 'admin123!@#';
        
        try {
            log.textContent += 'ê´€ë¦¬ì ë¡œê·¸ì¸ ì¤‘...\n';
            const loginRes = await axios.post('/api/auth/login', {
                email: loginEmail,
                password: loginPassword
            });
            
            const token = loginRes.data.token;
            const headers = { Authorization: `Bearer ${token}` };
            log.textContent += 'âœ“ ë¡œê·¸ì¸ ì„±ê³µ\n\n';

            // ìº í˜ì¸ë³„ ì§€ì› ì„¤ì •
            const campaigns = [
                { id: 13, title: 'ì¹˜í‚¨ ìº í˜ì¸', influencers: [17,18,19,20,21,22,23,24,25,26,27,28] },
                { id: 14, title: 'ì˜¤ëŠ˜ì€ì•„ë¥´ê¸°ë‹Œ', influencers: [17,18,19,20,21,22,23,24,25,26,29] },
                { id: 16, title: 'ì›¨ì´í°', influencers: [17,18,19,20,21,22,23,24,25,26,27,28,30] },
                { id: 17, title: 'ì›ë‘ì»¤í”¼', influencers: [17,18,19,20,21,22,23,24,25,26,29] },
                { id: 18, title: 'í™”ë³‘', influencers: [17,18,19,20,21,22,23,24,25,26,27,28] }
            ];

            for (const campaign of campaigns) {
                log.textContent += `\nğŸ“‹ ìº í˜ì¸ ${campaign.id} (${campaign.title}) ì²˜ë¦¬ ì¤‘...\n`;
                
                for (const num of campaign.influencers) {
                    const email = `influencer${num}@test.com`;
                    const password = 'Test1234!';
                    
                    try {
                        // ì¸í”Œë£¨ì–¸ì„œë¡œ ë¡œê·¸ì¸
                        const influencerLoginRes = await axios.post('/api/auth/login', {
                            email: email,
                            password: password
                        });
                        
                        const influencerToken = influencerLoginRes.data.token;
                        const influencerHeaders = { Authorization: `Bearer ${influencerToken}` };
                        
                        // ìº í˜ì¸ ì§€ì›
                        await axios.post(`/api/campaigns/${campaign.id}/apply`, {}, influencerHeaders);
                        log.textContent += `  âœ“ ${email} ì§€ì› ì™„ë£Œ\n`;
                        
                        // ì•½ê°„ì˜ ë”œë ˆì´
                        await new Promise(resolve => setTimeout(resolve, 100));
                    } catch (err) {
                        if (err.response?.data?.error === 'ì´ë¯¸ ì§€ì›í•œ ìº í˜ì¸ì…ë‹ˆë‹¤') {
                            log.textContent += `  âŠ™ ${email} ì´ë¯¸ ì§€ì›ë¨\n`;
                        } else {
                            log.textContent += `  âœ— ${email} ì‹¤íŒ¨: ${err.response?.data?.error || err.message}\n`;
                        }
                    }
                }
            }

            log.textContent += '\n\nğŸ‰ ëª¨ë“  ì‘ì—… ì™„ë£Œ!\n';
            log.textContent += 'í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ í™•ì¸í•˜ì„¸ìš”.';
            
        } catch (error) {
            log.textContent += '\nâŒ ì˜¤ë¥˜ ë°œìƒ: ' + (error.response?.data?.error || error.message);
        }
    }
    </script>
</body>
</html>
